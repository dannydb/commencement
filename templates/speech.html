{% extends '_base.html' %}

{% block body_class %}speech{% if speech.img %} has-mug{% endif %}{% endblock body_class %}

{% block extra_head %}
{# Twitter #}
{% if speech.money_quote2 %}
<meta name="twitter:card" content="gallery">
<meta name="twitter:image0:src" content="{{ money_quote_image }}">
<meta name="twitter:image1:src" content="{{ money_quote2_image }}">
{% else %}
<meta name="twitter:card" content="photo">
<meta name="twitter:image" content="{{ money_quote_image }}" />
{% endif %}
<meta name="twitter:site" content="{{ TWITTER_HANDLE }}">
<meta name="twitter:title" content="{{ share_text }}">

{# Facebook #}
<meta property="og:title" content="{{ COPY.sharing.facebook_title }}" />
<meta property="og:url" content="{{ share_url }}" />
<meta property="og:type" content="article" />
<meta property="og:description" content="{{ COPY.sharing.facebook_text }}" />
<meta property="og:image" content="{{ FACEBOOK_IMAGE_URL }}" />
<meta property="og:site_name" content="NPR.org" />
<meta property="fb:app_id" content="{{ FACEBOOK_APP_ID }}" />

{# Google News #}
<meta name="thumbnail" content="{{ GOOGLE_IMAGE_URL }}" />

{# The speech #}
<script>
    var speechSlug = '{{ speech.slug}}';
</script>
{% endblock extra_head %}

{% block header_content %}
<header>
    <div class="container">
        <div class="header-wrapper">
        	<h2 class="npr"><a href="http://npr.org"><img src="{{ S3_BASE_URL }}/assets/npr-black.png" alt="NPR" /></a></h2>
            <h1><a href="{{ S3_BASE_URL }}"><h1>{{ COPY.content.header|safe|typogrify }}</h1></a></h1>
        </div>
    </div>
    <div id="bigbox">
        {# 300x250 ad #}
        <div class="adwrapper">
            <div id="ad-desktop" class="sponsor300">
            </div>
        </div>
    </div>
</header>
{% endblock %}

{% block content %}


<div class="container">
    <div class="row">
        <div class="speech-header">
            {% if speech.img %}
            <div class="mug">
                <img src="{{ S3_BASE_URL }}/assets/mugs/{{ speech.img }}">
            </div>
            {% endif %}
            <h1>{{ speech.name }}</h1>
            <p class="speech-info">{{ speech.school }}, {{ speech.date }}</p>
        </div>


        <div class="speech-quotes">
            {% if speech.money_quote %}
                {% with number=1, speech=speech, quote=speech.money_quote, image=money_quote_image %}
                    {% include '_money_quote.html' %}
                {% endwith %}
            {% endif %}

            {% if speech.money_quote2 %}
                {% with number=2, speech=speech, quote=speech.money_quote2, image=money_quote2_image %}
                    {% include '_money_quote.html' %}
                {% endwith %}
            {% endif %}
        </div>

        <ul class="external-links">
            {% if speech.full_text %}
            <li class="full-text"><a href="{{ speech.full_text }}">Read the full text at {{ speech.web_source_credit }} <i class="fa fa-angle-right"></i></a></li>
            {% elif speech.source_url %}
            <li class="full-text"><a href="{{ speech.source_url }}">Read the full text at {{ speech.web_source_credit }} <i class="fa fa-angle-right"></i></a></li>
            {% endif %}


            {% if speech.video_url and not speech.youtube_id and not speech.vimeo_id %}
            <li class="video-link"><a href="{{ speech.video_url }}">{{ COPY.content.watch_link }} <i class="fa fa-angle-right"></i></a></li>
            {% endif %}
        </ul>
    </div>
</div>

{% if speech.youtube_id or speech.vimeo_id %}
<div class="video-container">
    <div class="container">
        <div class="row">
            <div class="speech-video">
                <div class="video-wrapper">
                    {% if speech.youtube_id %}
                        <iframe id="player" type="text/html" width="100%" height="100%"
                          src="http://www.youtube.com/embed/{{ speech.youtube_id }}?enablejsapi=1"
                          frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>
                    {% elif speech.vimeo_id %}
                        <iframe src="//player.vimeo.com/video/{{ speech.vimeo_id }}" width="100%" height="100%" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</div>
{% endif %}
{% endblock %}

{% block comments %}
<div class="more-speeches">
    <div class="container">
        <div class="row">
            <div class="next-speech">
                {% for tag, tag_name in TAGS.items() %}
                    {% if tag in speech['tags'] %}
                        {% for related in speech['related'][tag][0:1] %}
                        <a class="topic" href="{{ S3_BASE_URL }}/speech/{{ related.slug }}/">
                                {% if related.img %}<img class="img-circle" src="{{ S3_BASE_URL }}/assets/mugs/{{ related.img }}">{% endif %}
                                <h3><span>Next &ldquo;{{ tag_name }}&rdquo; speech&nbsp;<i class="fa fa-angle-right"></i></span></h3>

                                <h4><span>{{ related.name }}</span></h4>
                                <p>{{ related.school }}, {{ related.year }}</p>
                            </a>
                        {% endfor %}
                    {% endif %}
                {% endfor %}
            </div>
        </div>
    </div>
</div>

<div class="comments-wrapper">
    <div class="container">
        <div class="row">
            <div id="comments"></div>
        </div>
    </div>
</div>
{% endblock %}


{% block extra_foot_js %}
    {{ JS.push('js/app.js') }}
    {{ JS.push('js/comments.js') }}
    {{ JS.render('js/app-footer-speech.min.js') }}
{% endblock %}

